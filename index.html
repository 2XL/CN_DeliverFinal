<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
	<title>CN Final</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="shortcut icon" href="favicon.ico" > 
	<link rel="stylesheet" href="js/twitter-bootstrap/css/bootstrap.css">
	<link rel="stylesheet" href="css/style.css">
	<script src="js/jquery/jquery.js"></script>
	<script src="js/twitter-bootstrap/js/bootstrap.js"></script>
	<script src="js/util.js"></script>
	<script src="js/script.js"></script>
	<script src="js/FileSaver.js"></script>
	<script src="js/papaparse.js"></script>
	<style>
	    .box-content {
		display: inline-block;
		width: 200px;
		padding: 10px;
	    }
	    .bottom {
		border-bottom: 1px solid #ccc;
	    }
	    .right {
		border-right: 1px solid #ccc;
	    }
	</style>
    </head>
    <body>
	<div>
	    <h1>Complex Network - Tweets</h1>
	</div>
	<script>

	    // STEP 0
	    // parsejar tots els tweets capturats
	    // - crear una classe tweet

	    var network = []; // llista de tots els usuaris

	    // pensar en usuari com a node i tweets com a aristes
	    var user = function () {
		this.in = []; // tweets entrants
		this.out = []; // tweets sortint
		this.hashtags = {};
	    };
	    var tweet = function () {
		// this.tweet = parseTweet();
	    };


	    // un cop tingui el graf de tots json parsejats 

	    function parseTweet(tweet) {
		return{
		    created_at: tweet.created_at,
		    text: tweet.text, // "RT @kim_soler: Aha, entenc ! #CiudadanosCs Quina poca vergonya @Albert_Rivera, s'ha de tenir molta jeta !\n\nhttps://t.co/PtK0nSXHmn http://tâ€¦",
		    user: tweet.user,
		    // screen_name // avatar name
		    // location // mataro
		    // description // self describe profile usuario 
		    // follower_count // peso del usuario
		    // listed_count // veces listado!!! influencia real usuario
		    // profile_image_url // mostrar imagen del user como nodo
		    retweeted_status: tweet.retweeted_status,
		    entities: tweet.entities
			    // hashtags: [text]
			    // symbols
			    // user_mentions: screen_name


			    // boud rest api for the sintaxi analysis, and profile the user


		};
	    }

	    function parsetRetweet(retweet) {
		return{
		};
	    }

	    var data_source =
		    [
			"ahorapodemos",
			"compromis",
			"omnium",
			"cupnacional",
			"PPopular",
			"ERC",
			"PSOE",
			"CiudadanosCs",
			"ForoAsturias",
			"UPyD",
			"ciu",
			"geroabai",
			"viacatalana",
			"ciutadans",
			"iunida",
			"coalicion",
			"obloque"
		    ];
		    
	    var dataset = {};
	    
	    var data_load_status = 0; // fins recollectar tot
	    
	    
	    
	    data_source.map(function (item) {
		// console.log(item);
		loadJSON('data/'+item+'.json', function(data){
		    data_load_status++;
		    dataset[item] = JSON.parse(data);
		});
	    });
	    
	    
	    
	    var itv_load_status = setInterval(function(){
		if(data_load_status !== data_source.length){
		    console.log("loadStatus: "+data_load_status+"/"+data_source.length);
		}else{
		    console.log("loadStatus: Complete!");
		    startParseDataset(data_source);
		    clearInterval(itv_load_status);
		}
	    }, 500);
	    
	    
	    
	    
	    function startParseDataset(data){
		
		tweets = {};
		
		data_source.map(function(item){
		    // console.log(dataset[item]);
		    dataset[item].map(function(t){
			if(tweets[t.id] === undefined){
			    tweets[t.id] = t;
			};
		    });
		});
		
		
		// console.log(tweets);
	
		console.log("Tweets collected: "+Object.keys(tweets).length);
		
		// tweets collection start time
		var list = Object.keys(tweets);
		var listInt = list.map(function(item){ return parseInt(item);});
		var minKey = Math.min.apply(null, listInt);
		//console.log(minKey);
		console.log("Collection period: \n>>Start >> "+ tweets[minKey].created_at);
		// tweets collection end time
		var maxKey = Math.max.apply(null, listInt);
		//console.log(maxKey);
		console.log(">>Finish>> "+ tweets[maxKey].created_at);
	    }
	    
 


	    




	</script>

    </body>
</html>
